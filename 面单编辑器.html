<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Vue 测试实例 - 菜鸟教程(runoob.com)</title>
	<script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
	<style>
		#header {
			background-color:black;
			color:white;
			text-align:center;
			padding:5px;
		}
		#nav {
			line-height:30px;
			background-color:#eeeeee;
			
			width:12cm;
			float:left;
			padding:5px;	      
		}
		#section {
			width:12cm;
			float:left;
			padding:10px;	 	 
		}
		#footer {
			background-color:black;
			color:white;
			clear:both;
			text-align:center;
			padding:5px;	 	 
		}
		.content-row{
  			display: flex;
  			flex-direction: row;

		}
		.child-column{
			display: flex;
  			flex-direction: column;
		}
	</style>
</head>
<body>
	<div id="header">
		<h1>面单编辑器</h1>
	</div>

	<div id="nav">
		<div id="page"  style="height: 15cm;width: 10cm; border:1px solid #000; margin: 1cm">
			<div id='div' style="height: 1cm;border:1px solid #000; margin-right: -1px;margin-bottom: -1px;margin-left: -1px;margin-top: -1px" >1</div>  
		</div>
	</div>

	<div id="section" style="width: 12cm ;display: flex; flex-direction: row;">
		
		<div >
			<h1 style="width: 12cm ">编辑</h1>
			<div id='edit' style="display: inline; margin: 1cm; width: 15cm">
				
			</div>
		</div>
		<div class='child-column' >
			<div style="display: inline; margin: 1cm">
				<input value="1" onkeyup="setHeight(this.value)">
				<input value="1" onkeyup="setWidth(this.value)">
				<button onclick="addLine()"> 新建 </button>
			</div>
		</div>
	</div>


	<div style="display: inline;">
	</div>
	
	<script type="text/javascript">
		//字典
		var map = {
			"x":"x坐标: ",
			"y":"y坐标: ",
			"w":"宽: ",
			"h":"高: ",
			"data":"数据: ",
			"grid":"格子 ",
			"txt":"文本 ",
			"barcode":"条码 ",
			"QRcode":"二维码 ",
			"img":"图片 ",
			"src":"链接地址: ",
			"hede":"是否隐藏: ",
			"code":"编码: ",
			"size":"字体尺寸: ",
			"font":"字体: ",
			"lineSpace":"行间距: ",
			"direction":"方向: ",
			"margin":"边距: ",
			"ih":"初始高度: "
		};

		var order = 1;
		var currentDiv = document.getElementById("div");

		function select(argument) {
			// body...
		}

		function put(value) {
			//alert(value);
			var div = document.getElementById("div");//创建div，名称为div
			if(value<15){
				div.style.height = value + "cm";
				div.style.width = value + "cm";
			}

		}

		function setHeight(value) {
			//alert(value);
			var div = document.getElementById("div");//创建div，名称为div
			if(value<15){
				div.style.height = value + "cm";
			}

		}

		function setWidth(value) {
			//alert(value);
			var div = document.getElementById("div");//创建div，名称为div
			if(value<15){
			 	div.style.width = value + "cm";
			}

		}

		function addLine(value) {
			var obj = {
				"x":1,
				"y":3,
				"w":4,
				"h":5,
				"grid":{
					"x":444,
					"y":3,
					"grid_2":{
						"w":22,
						"h":55
					}
				}
			}

			var page = {
				w:9.6,
				h:14.8,
				margin:0.2,
				ih:0.2,
				grid_1:{
					x:0,
					y:0,
					w:9.6,
					h:1,
					txt_express:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"10008993"
					}
				},
				grid_2:{
					x:0,
					y:1,
					w:4.8,
					h:1,
					txt_receiver:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"收件人"
					}
				},
				grid_3:{
					x:4.8,
					y:1,
					w:4.8,
					h:1,
					txt_sender:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"寄件人"
					}
				},
				grid_4:{
					x:4.8,
					y:2,
					w:4.8,
					h:2,
					txt_address:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"地址"
					}
				},
				grid_5:{
					x:4.8,
					y:2,
					w:4.8,
					h:2,
					txt_tel:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"电话号码"
					}
				},
				grid_6:{
					x:9.6,
					y:4,
					w:9.6,
					h:1,
					txt_remark:{
						x:0.1,
						y:0.1,
						w:2,
						h:0.5,
						font:'黑体',
						size:6,
						txt:"备注信息"
					}
				}
			};


			var edit = document.getElementById("edit");
			edit.style.width = '12cm';
			createEditByObject(page,edit);


			order++;
			//alert(value);
			var a = {
				"name":1111,
				"code":2222
			}

			console.log(a);
			var page = document.getElementById("page");//创建div，名称为div
			var line = document.createElement("div");
			line.innerHTML= order;
			line.style.border = "1px solid #CCCCCC";
			line.style.height = "1cm";
			//line.style.marginRight = "-1px";
			//line.style.marginBottom = "-1px";
			//line.style.marginLeft = "-1px";
			line.style.marginTop = "-2px";	
			page.appendChild(line);

		}

		function splitH() {
			var input = document.getElementById("splitInput");
			var op = input.value;
			if(op.indexOf("|") != -1){
				var splitInfo = op.split('|');
				for (var i = 0; i < splitInfo.length; i++) {
					splitInfo[i]
				}
			}
		}

		//通过 object 生成页面编辑器
		function createEditByObject(obj,div) {
			Object.keys(obj).forEach(function(key){

				console.log(key,obj[key]);
				//alert(typeof(obj[key]));
				if(typeof(obj[key]) === "object"){
					var child = document.createElement("div");
					child.id = key+"-object";
					div.class = 'child-column';

					insertDiv(key,div,child);
					createEditByObject(obj[key],child);
				}else if(typeof(obj[key]) === "number"){
					var input = document.createElement("input");
					input.id = key;
					input.type = "number";
					input.value = obj[key];
					insertDiv(key,div,input);

				}else if(typeof(obj[key]) === "string"){
					var input = document.createElement("input");
					input.id = key;
					//input.type = "string";
					input.value = obj[key];
					insertDiv(key,div,input);
				}else if(typeof(obj[key]) === "boolean"){
					var input = document.createElement("input");
					input.id = key;
					input.type = "radio";
					input.value = obj[key];
					insertDiv(key,div,input);
				}

			});
		}


		//将生成的组件插入对应的 div 中
		function insertDiv(key,div,child) {
			var content = document.createElement("div");
			var label = document.createElement("label");

			//id 样式设置
			content.id = key;
			content.class = 'content-row';
			//content.style.border = "2px solid #CCCCCC";
			content.style.margin = "0.2cm 0.2cm 0.2cm 1.0cm ";

			//为子节点添加可折叠属性
			if(child.id == (key+"-object")){
				var flag = document.createElement("label");
				flag.innerHTML = "+";
				child.style.display = 'none';
				content.appendChild(flag);
				label.onclick = function remo()
				{
					if(child.style.display == 'block'){
						child.style.display = 'none';
						flag.innerHTML = "+";
					}else{
						child.style.display = 'block';
						flag.innerHTML = "-";
					}					
				};

				flag.onclick = function remo()
				{
					if(child.style.display == 'block'){
						child.style.display = 'none';
						flag.innerHTML = "+";
					}else{
						child.style.display = 'block';
						flag.innerHTML = "-";
					}					
				};
			}

			
			//child.style.border = "1px solid #000";
			
			var cName ="";
			if(key.indexOf('_')!=-1){
				cName = map[key.split('_')[0]] + key.split('_')[1];
			}else{
				cName = map[key];
			}
			label.innerHTML = cName;

			content.appendChild(label);
			content.appendChild(child);
			div.appendChild(content);
		}

		function createPageByObject(obj,div) {
			var page_w = 10;
			var page_h = 1;
			var page_x = 0;
			var page_y = 0;

			page_w = obj.w - obj.margin * 2;
			page_h = obj.h - obj.ih;
			page_x = obj.margin;
			page_y = obj.ih;

			var pageOutline = document.createElement("div");
			pageOutline.style.width = obj.w + "cm";
			pageOutline.style.height = obj.h + "cm";
			pageOutline.style.border = "1px solid #000";
			//pageOutline.style.position = "relative";

			var pageDiv = document.createElement("div");
			pageDiv.style.position = "relative";
			pageDiv.style.left = page_x+"cm";
			pageDiv.style.top = page_y+"cm";



			Object.keys(obj).forEach(function(key){
				console.log(key,obj[key]);

				if(typeof(obj[key]) === "object"){
					var child = document.createElement("div");
					child.id = key+"-object";
					div.class = 'child-column';

					insertDiv(key,div,child);
					createPageByObject(obj[key],child);
				}


			});
		}

	</script>
</body>
</html>